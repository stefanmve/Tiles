"use strict";function position(i,t,e){i.setAttribute("style","left:"+t*unitWidth+"px; top:"+e*unitWidth+"px;")}function Grid(i,t){this.col=i,this.rows=t,this.grid=[],this.init=function(){for(var e=1;t*i>=e;e++)this.grid.push(0)},this.find=function(e,r){var l=tileSizes[r];if(1===l[0]&&1===l[1])for(var s=0;i*t>s;s++)if(0===this.grid[s])return this.grid[s]=r,this.place(s);if(2===l[0]&&1===l[1])for(var s=0;i*t>s;s++)if(0===this.grid[s]&&0===this.grid[s+1]&&(s+1)%i!==0)return this.grid[s]=r,this.grid[s+1]=r,this.place(s);if(1===l[0]&&2===l[1])for(var s=0;i*t+i>s;s++)if(0===this.grid[s]&&0===this.grid[s+i])return this.grid[s]=r,this.grid[s+i]=r,this.place(s)},this.place=function(t){if(0===t)var e=0,r=0;else if(t%i===0)var e=Math.ceil(t/i),r=t%i;else var e=Math.ceil(t/i)-1,r=t%i;return{x:r,y:e,index:t}}}function getScrollerWidth(){var i=null,t=null,e=0,r=0;return i=document.createElement("div"),i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.style.width="100px",i.style.height="50px",i.style.overflow="hidden",t=document.createElement("div"),t.style.width="100%",t.style.height="200px",i.appendChild(t),document.body.appendChild(i),e=t.offsetWidth,i.style.overflow="auto",r=t.offsetWidth,document.body.removeChild(document.body.lastChild),e-r}var container=document.getElementById("container"),winWidth=window.innerWidth-getScrollerWidth(),tiles=document.getElementsByClassName("tile"),tileCopy=[],tilesLength=tiles.length,totalTiles=tilesLength,tileSizes={basic:[1,1],filler:[1,1],tall:[1,2],wide:[2,1]},col=5,unit=winWidth/col,totalArea=0,docfrag=document.createDocumentFragment(),remainder,filler=0;Array.prototype.shuffle=function(){for(var i=this,t=i.length-1;t>=0;t--){var e=Math.floor(Math.random()*(t+1)),r=i[e];i[e]=i[t],i[t]=r}return i};for(var i=0;tilesLength>i;i++){var size,area;size="string"==typeof tiles[i].classList[1]?tiles[i].classList[1]:"basic",area=tileSizes[size][0]*tileSizes[size][1],totalArea+=area,tiles[i].innerHTML="<div class='content'>"+tiles[i].innerHTML+"</div>",tileCopy.push([tiles[i].outerHTML,size])}remainder=totalArea%col,0!==remainder&&(filler=2*col-remainder),totalTiles+=filler;for(var i=tilesLength;totalTiles>i;i++){var size="filler",area=tileSizes[size][0]*tileSizes[size][1];tileCopy.push(["<div class='tile filler'><div class='content'></div></div>",size]),totalArea+=area}for(var rows=totalArea/col;container.hasChildNodes();)container.removeChild(container.lastChild);tileCopy.shuffle();var griddy=new Grid(col,rows);griddy.init();for(var last=0,nextXCoord=0,nextYCoord=0,i=0;i<tileCopy.length;i++){var div=document.createElement("div"),size=tileCopy[i][1],unitWidth=winWidth/col;div.innerHTML=tileCopy[i][0];var insert=div.firstChild;if("filler"!==size){var coords=griddy.find(insert,size);docfrag.appendChild(insert),insert.setAttribute("style","left:"+coords.x*unitWidth+"px; top:"+coords.y*unitWidth+"px;")}}for(var i=0;i<tileCopy.length;i++){var div=document.createElement("div"),size=tileCopy[i][1],unitWidth=winWidth/col;div.innerHTML=tileCopy[i][0];var insert=div.firstChild;if("filler"===size){var coords=griddy.find(insert,size);docfrag.appendChild(insert),insert.setAttribute("style","left:"+coords.x*unitWidth+"px; top:"+coords.y*unitWidth+"px;")}}container.appendChild(docfrag),container.removeAttribute("class");